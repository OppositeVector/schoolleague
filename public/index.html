<!DOCTYPE html>
<html>
	<head>
		<title>CHANGE THIS</title>
		<link rel = "stylesheet" href = "includes/css/style.css">
		<script type="text/javascript" src="includes/js/lib/jquery/jquery-2.1.4.min.js"></script>
		<script type="text/javascript" src="includes/js/lib/angular/angular.min.js"></script>

		<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
		<link href='https://fonts.googleapis.com/css?family=Alef:400,700' rel='stylesheet' type='text/css'>
		<meta charset="utf-8">
	</head>

	<body dir="rtl">
		<div id="wrapper">
			<header>
				<section id="logo">לוגו</section>

				<nav>
					<a href="#">על הפרוייקט</a>
					<a href="#">על הרפורמה</a>
				</nav>
			</header>

			<section id="searchBox">
				<h3>הזן כתובת/מיקוד או בית ספר:</h3>
				<input type="search" name="schoolSearch" id="schoolSearch">
			</section>
		</div>

		<div id="google_map">

		</div>

		<!-- <div id="over_map">

     </div> -->

		<script>
			function initMap() {
				var map = new google.maps.Map(document.getElementById('google_map'), {
					center: {lat: -34.397, lng: 150.644},
					zoom: 13
				});

				var geocoder = new google.maps.Geocoder;
				var infoWindow = new google.maps.InfoWindow({map: map});

				// Try HTML5 geolocation.
				if (navigator.geolocation) {
					navigator.geolocation.getCurrentPosition(function(position) {
						var pos = {
							lat: position.coords.latitude,
							lng: position.coords.longitude
						};


						geocodeLatLng(geocoder, map, infoWindow, pos);
						// infoWindow.setPosition(pos);
						// infoWindow.setContent(geocodeLatLng(geocoder, map, infowindow););
						// map.setCenter(pos);
					}, function() {
						handleLocationError(true, infoWindow, map.getCenter());
					});
				} else {
					// Browser doesn't support Geolocation
					handleLocationError(false, infoWindow, map.getCenter());
				}
			}

			function geocodeLatLng(geocoder, map, infowindow, pos) {
				console.log(pos);
				// var input = document.getElementById('latlng').value;
				// var latlngStr = input.split(',', 2);
				var latlng = {lat: pos.lat, lng: pos.lng};
				geocoder.geocode({'location': latlng}, function(results, status) {
					if (status === google.maps.GeocoderStatus.OK) {
						if (results[1]) {
							map.setZoom(15);
							var marker = new google.maps.Marker({
								position: latlng,
								map: map
							});
							infowindow.setContent(results[1].formatted_address);
							infowindow.open(map, marker);
							map.setCenter(pos);
						} else {
							window.alert('No results found');
						}
					} else {
						window.alert('Geocoder failed due to: ' + status);
					}
				});
			}

			function handleLocationError(browserHasGeolocation, infoWindow, pos) {
				infoWindow.setPosition(pos);
				infoWindow.setContent(browserHasGeolocation ?
						'Error: The Geolocation service failed.' :
						'Error: Your browser doesn\'t support geolocation.');
			}
		</script>
		<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyChdLZaHDeW0jF91EDWtfnVjzXGC453b3I&signed_in=true&callback=initMap&language=iw"
				async defer></script>
	</body>
</html>